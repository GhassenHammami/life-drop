{# templates/profile/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}
    My profile — LifeDrop
{% endblock %}

{% block body %}
    {% set profile = app.user ? app.user.userProfile : null %}

    <div class="mx-auto max-w-6xl px-6 py-10 md:py-14">
        <div class="mx-auto max-w-4xl">
            <div class="flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between">
                <div>
                    <h1 class="text-4xl font-bold tracking-tight">
                        My profile
                    </h1>
                    <p class="mt-3 text-slate-300/90">
                        This is the information others may use to contact you. You can edit it anytime.
                    </p>
                </div>

                <a href="{{ path('app_profile_edit') }}" class="inline-flex w-fit items-center justify-center rounded-2xl bg-rose-600 px-4 py-2 text-sm font-semibold text-white
                        hover:bg-rose-500 shadow-lg shadow-rose-600/25 active:scale-[0.99]
                    focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60">
                    Edit profile
                </a>
            </div>

            {% for message in app.flashes('success') %}
                <div class="mt-6 rounded-2xl border border-emerald-500/25 bg-emerald-500/10 p-4 text-sm text-emerald-100">
                    {{ message }}
                </div>
            {% endfor %}

            {% if not profile %}
                <div class="mt-6 rounded-2xl border border-rose-500/25 bg-rose-600/10 p-4 text-sm text-rose-100">
                    <div class="font-semibold">
                        Profile not set up yet
                    </div>
                    <div class="mt-1 text-rose-100/90">
                        Please complete your profile to unlock the website.
                    </div>
                </div>

                <div class="mt-6">
                    <a href="{{ path('app_profile_edit') }}" class="inline-flex w-fit items-center justify-center rounded-2xl bg-white/5 px-4 py-2 text-sm font-semibold text-slate-100
                        ring-1 ring-white/10 hover:bg-white/10">
                        Start setup
                    </a>
                </div>
            {% else %}
                <div class="mt-8 rounded-3xl bg-linear-to-b from-white/10 to-white/5 p-1 ring-1 ring-white/10">
                    <div class="rounded-3xl bg-slate-950/60 p-6 backdrop-blur md:p-8">
                        <div class="grid gap-6 md:grid-cols-2">
                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    Full name
                                </div>
                                <div class="mt-2 text-lg font-semibold text-slate-100">
                                    {{ profile.fullName ?: '—' }}
                                </div>
                            </div>

                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    Phone
                                </div>
                                <div class="mt-2 text-lg font-semibold text-slate-100">
                                    {{ profile.phone ?: '—' }}
                                </div>
                            </div>

                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    City
                                </div>
                                <div class="mt-2 text-lg font-semibold text-slate-100">
                                    {{ profile.city ?: '—' }}
                                </div>
                            </div>

                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    Availability
                                </div>
                                <div class="mt-2 inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm font-semibold
                                    {{ profile.available ? 'bg-emerald-500/15 text-emerald-200 ring-1 ring-emerald-400/20' : 'bg-white/5 text-slate-200 ring-1 ring-white/10' }}">
                                    <span class="h-1.5 w-1.5 rounded-full {{ profile.available ? 'bg-emerald-300' : 'bg-slate-300/60' }}"></span>
                                    {{ profile.available ? 'Available to donate' : 'Not available right now' }}
                                </div>
                            </div>

                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    Blood type
                                </div>
                                <div class="mt-2 text-lg font-semibold text-slate-100">
                                    {{ profile.bloodType ?: '—' }}
                                </div>
                            </div>

                            <div class="rounded-2xl bg-white/5 p-5 ring-1 ring-white/10">
                                <div class="text-xs font-semibold text-slate-300/80">
                                    Last donation date
                                </div>
                                <div class="mt-2 text-lg font-semibold text-slate-100">
                                    {{ profile.lastDonationDate ? profile.lastDonationDate|date('Y-m-d') : '—' }}
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 text-xs text-slate-400">
                            Tip: Keep your phone number accurate so hospitals or requesters can reach you quickly.
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
