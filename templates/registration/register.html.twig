{# templates/registration/register.html.twig #}
{% extends 'base.html.twig' %}
{% block title %}
	Create account — LifeDrop
{% endblock %}
{% block body %}
	<div	class="mx-auto max-w-6xl px-6 py-10 md:py-16">
		<div	class="grid gap-10 md:grid-cols-2 md:items-center">
			{# Left: message #}
			<div	class="hidden md:block">
				<h1	class="text-4xl font-bold tracking-tight">
					Join LifeDrop.
				</h1>
				<p	class="mt-3 text-slate-300/90">
					Create an account to post urgent requests, offer to donate, and get updates until it’s solved.
				</p>
			</div>
			{# Right: form card #}
			<div>
				<div	class="mx-auto max-w-md">
					<div	class="rounded-3xl bg-linear-to-b from-white/10 to-white/5 p-1 ring-1 ring-white/10">
						<div	class="rounded-3xl bg-slate-950/60 p-6 backdrop-blur md:p-8">
							<div>
								<h2	class="text-2xl font-bold tracking-tight">
									Create account
								</h2>
								<p	class="mt-1 text-sm text-slate-300/90">
									Use a valid email and choose a strong password.
								</p>
							</div>
							{# Form errors (top) #}
							{% if form_errors(registrationForm) %}
								<div	class="mt-5 rounded-2xl border border-rose-500/25 bg-rose-600/10 p-4 text-sm text-rose-100">
									{{ form_errors(registrationForm) }}
								</div>
							{% endif %}
							{{ form_start(registrationForm, {'attr': {'class': 'mt-6 space-y-4', 'id': 'register-form' }}
							) }}
							<div>
								<label	class="mb-2 block text-sm font-medium text-slate-200/90">
									{{ form_label(registrationForm.email) }}
								</label>
								{{ form_widget(registrationForm.email, {
                     attr: {
                     class: 'w-full rounded-2xl bg-white/5 px-4 py-3 text-sm text-slate-100 placeholder:text-slate-400/70 ring-1 ring-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60',
                     placeholder: 'you@example.com'
                     }
                     }) }}
								<div	class="mt-2 text-xs text-rose-200/90">
									{{ form_errors(registrationForm.email) }}
								</div>
							</div>
							{# Password + eye toggle #}
							<div>
								<label	class="mb-2 block text-sm font-medium text-slate-200/90">
									Password
								</label>
								<div	class="relative">
									{{ form_widget(registrationForm.plainPassword, {
                        attr: {
                        class: 'w-full rounded-2xl bg-white/5 px-4 py-3 pr-12 text-sm text-slate-100 placeholder:text-slate-400/70 ring-1 ring-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60',
                        placeholder: '••••••••',
                        autocomplete: 'new-password'
                        }
                        }) }}
									<button	type="button"	id="toggle-password"	class="absolute inset-y-0 right-2 my-auto grid h-10 w-10 place-items-center rounded-xl bg-white/0 text-slate-300/80 hover:bg-white/5 hover:text-slate-100 ring-1 ring-transparent hover:ring-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60"	aria-label="Show password">
										<svg	id="eye-open-1"	xmlns="http://www.w3.org/2000/svg"	viewbox="0 0 24 24"	fill="none"	class="h-5 w-5"	stroke="currentColor"	stroke-width="1.8">
											<path	d="M2.25 12s3.75-7.5 9.75-7.5S21.75 12 21.75 12s-3.75 7.5-9.75 7.5S2.25 12 2.25 12z" />
											<path	d="M12 15.75A3.75 3.75 0 1 0 12 8.25a3.75 3.75 0 0 0 0 7.5z" />
										</svg>
										<svg	id="eye-closed-1"	xmlns="http://www.w3.org/2000/svg"	viewbox="0 0 24 24"	fill="none"	class="hidden h-5 w-5"	stroke="currentColor"	stroke-width="1.8">
											<path	d="M3 3l18 18" />
											<path	d="M10.58 10.58A3 3 0 0 0 12 15a3 3 0 0 0 1.42-.36" />
											<path	d="M9.88 5.2A10.5 10.5 0 0 1 12 4.5c6 0 9.75 7.5 9.75 7.5a18.6 18.6 0 0 1-3.01 4.2" />
											<path	d="M6.2 6.2C3.6 8.1 2.25 12 2.25 12S6 19.5 12 19.5c1.1 0 2.14-.2 3.12-.56" />
										</svg>
									</button>
								</div>
								<div	class="mt-2 text-xs text-rose-200/90">
									{{ form_errors(registrationForm.plainPassword) }}
								</div>
								<div	class="mt-2 text-xs text-slate-400">
									Use at least 6 characters (more is better).
								</div>
							</div>
							{# Confirm password (client-side check) + eye toggle #}
							<div>
								<label	for="confirm_password"	class="mb-2 block text-sm font-medium text-slate-200/90">
									Repeat password
								</label>
								<div	class="relative">
									<input	type="password"	name="confirm_password"	id="confirm_password"	class="w-full rounded-2xl bg-white/5 px-4 py-3 pr-12 text-sm text-slate-100 placeholder:text-slate-400/70 ring-1 ring-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60"	placeholder="••••••••"	autocomplete="new-password"	required>
										<button	type="button"	id="toggle-confirm"	class="absolute inset-y-0 right-2 my-auto grid h-10 w-10 place-items-center rounded-xl bg-white/0 text-slate-300/80 hover:bg-white/5 hover:text-slate-100 ring-1 ring-transparent hover:ring-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60"	aria-label="Show repeated password">
											<svg	id="eye-open-2"	xmlns="http://www.w3.org/2000/svg"	viewbox="0 0 24 24"	fill="none"	class="h-5 w-5"	stroke="currentColor"	stroke-width="1.8">
												<path	d="M2.25 12s3.75-7.5 9.75-7.5S21.75 12 21.75 12s-3.75 7.5-9.75 7.5S2.25 12 2.25 12z" />
												<path	d="M12 15.75A3.75 3.75 0 1 0 12 8.25a3.75 3.75 0 0 0 0 7.5z" />
											</svg>
											<svg	id="eye-closed-2"	xmlns="http://www.w3.org/2000/svg"	viewbox="0 0 24 24"	fill="none"	class="hidden h-5 w-5"	stroke="currentColor"	stroke-width="1.8">
												<path	d="M3 3l18 18" />
												<path	d="M10.58 10.58A3 3 0 0 0 12 15a3 3 0 0 0 1.42-.36" />
												<path	d="M9.88 5.2A10.5 10.5 0 0 1 12 4.5c6 0 9.75 7.5 9.75 7.5a18.6 18.6 0 0 1-3.01 4.2" />
												<path	d="M6.2 6.2C3.6 8.1 2.25 12 2.25 12S6 19.5 12 19.5c1.1 0 2.14-.2 3.12-.56" />
											</svg>
										</button>
									</div>
									<div	id="pw-status"	class="mt-2 text-xs text-slate-400">
										Re-enter your password to confirm it.
									</div>
								</div>
								<div	class="flex items-start gap-3">
									{{ form_widget(registrationForm.agreeTerms, {
                     attr: {
                     class: 'mt-1 h-4 w-4 rounded border-white/20 bg-white/10 text-rose-500 ring-1 ring-white/10 focus:ring-0 focus:outline-none'
                     }
                     }) }}
									<div	class="text-sm text-slate-200/90">
										<label	class="cursor-pointer select-none">
											{{ form_label(registrationForm.agreeTerms) }}
										</label>
										<div	class="mt-1 text-xs text-slate-400">
											Be respectful and keep personal info private.
										</div>
										<div	class="mt-1 text-xs text-rose-200/90">
											{{ form_errors(registrationForm.agreeTerms) }}
										</div>
									</div>
								</div>
								<button	type="submit"	id="register-submit"	class="mt-2 w-full cursor-pointer rounded-2xl bg-rose-600 px-5 py-3 text-sm font-semibold text-white
										hover:bg-rose-500 shadow-lg shadow-rose-600/25 active:scale-[0.99]
									focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60">
									Create account
								</button>
								<div	class="pt-2 text-center text-sm text-slate-300/90">
									Already have an account?
									<a	href="{{ path('app_login') }}"	class="underline decoration-white/15 underline-offset-4 hover:text-white">
										Log in
									</a>
								</div>
								{{ form_end(registrationForm) }}
								<div	class="mt-6 text-center text-xs text-slate-400">
									By creating an account, you agree to use LifeDrop respectfully and keep shared information private.
								</div>
							</div>
						</div>
						<div	class="mt-6 text-center text-xs text-slate-400">
							Need to go back?
							<a	href="{{ path('app_home') }}"	class="underline decoration-white/15 underline-offset-4 hover:text-white">
								Return to Home
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
		   (function () {
		     const pwd = document.getElementById('{{ registrationForm.plainPassword.vars.id }}');
		     const confirm = document.getElementById('confirm_password');
		     const status = document.getElementById('pw-status');
		     const form = document.getElementById('register-form');
		   
		     const btn1 = document.getElementById('toggle-password');
		     const eyeOpen1 = document.getElementById('eye-open-1');
		     const eyeClosed1 = document.getElementById('eye-closed-1');
		   
		     const btn2 = document.getElementById('toggle-confirm');
		     const eyeOpen2 = document.getElementById('eye-open-2');
		     const eyeClosed2 = document.getElementById('eye-closed-2');
		   
		     function toggleEye(btn, input, openIcon, closedIcon) {
		       if (!input) return;
		       const isHidden = input.type === 'password';
		       input.type = isHidden ? 'text' : 'password';
		       openIcon.classList.toggle('hidden', !isHidden);
		       closedIcon.classList.toggle('hidden', isHidden);
		       btn.setAttribute('aria-label', isHidden ? 'Hide password' : 'Show password');
		     }
		   
		     function checkMatch() {
		       const a = pwd?.value ?? '';
		       const b = confirm?.value ?? '';
		   
		       if (!b) {
		         status.textContent = 'Re-enter your password to confirm it.';
		         status.className = 'mt-2 text-xs text-slate-400';
		         return true;
		       }
		   
		       if (a === b) {
		         status.textContent = 'Passwords match ✓';
		         status.className = 'mt-2 text-xs text-emerald-200';
		         return true;
		       }
		   
		       status.textContent = 'Passwords do not match';
		       status.className = 'mt-2 text-xs text-rose-200';
		       return false;
		     }
		   
		     btn1?.addEventListener('click', () => toggleEye(btn1, pwd, eyeOpen1, eyeClosed1));
		     btn2?.addEventListener('click', () => toggleEye(btn2, confirm, eyeOpen2, eyeClosed2));
		   
		     pwd?.addEventListener('input', checkMatch);
		     confirm?.addEventListener('input', checkMatch);
		   
		     form?.addEventListener('submit', (e) => {
		       if (!checkMatch()) {
		         e.preventDefault();
		         confirm?.focus();
		       }
		     });
		   
		     checkMatch();
		   })();
		</script>
	{% endblock %}
	